{% extends "base.html" %}
{% block title %}{{ 'Crear' if modo=='crear' else 'Editar' }} producto — La Cevichoza{% endblock %}
{% block content %}
<h2 class="h4 mb-3">{{ 'Crear' if modo=='crear' else 'Editar' }} producto</h2>
<form method="post" class="card p-3">
  <div class="row g-3">
    <div class="col-md-6">
      <label class="form-label">Nombre</label>
      <input name="nombre" class="form-control" required value="{{ producto.nombre if producto }}">
    </div>
    <div class="col-md-6">
      <label class="form-label">Precio</label>
      <input name="precio" type="number" step="0.01" min="0" class="form-control" required value="{{ producto.precio if producto }}">
    </div>
    <div class="col-md-6">
      <label class="form-label">Stock</label>
      <input name="stock" type="number" min="0" class="form-control" required value="{{ producto.stock if producto }}">
    </div>
    <div class="col-md-6">
      <label class="form-label">Estado</label>
      <select name="estado" class="form-select">
        <option value="A" {{ 'selected' if producto and producto.estado=='A' }}>Activo</option>
        <option value="I" {{ 'selected' if producto and producto.estado=='I' }}>Inactivo</option>
      </select>
    </div>
    <div class="col-12">
      <label class="form-label">Descripción</label>
      <textarea name="descripcion" class="form-control" rows="3">{{ producto.descripcion if producto }}</textarea>
    </div>
    <div class="col-12">
      <label class="form-label">Categoría</label>
      {% if categorias and categorias|length > 0 %}
      <select name="id_categoria" class="form-select" required>
        <option value="">Selecciona una categoría</option>
        {% for c in categorias %}
          <option value="{{ c.id_categoria }}" {% if producto and producto.id_categoria == c.id_categoria %}selected{% endif %}>
            {{ c.nombre }}
          </option>
        {% endfor %}
      </select>
      {% else %}
      <div class="alert alert-warning">
        No hay categorías. <a href="{{ url_for('categorias_crear') }}" class="alert-link">Crea una categoría primero</a>.
      </div>
      {% endif %}
    </div>
  </div>
  <div class="mt-3">
    <button class="btn btn-primary">Guardar</button>
    <a href="{{ url_for('productos_listar') }}" class="btn btn-link">Cancelar</a>
  </div>
</form>
{% endblock %}
